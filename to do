
Bugs:

Got it. But the account creation and document submitting thing still isn't there for some reason.

And we got this bug that the line is over the icon

Investor tab:

# AI Implementation Prompt: Separate Investors Page & Onboarding/Pipeline System

---

## Context

You are working on an investor management platform for private equity and real estate funds. The platform currently has an "Investors" page that shows all people who have gone through any part of the process, creating confusion between:
- Prospects who just filled out KYC
- People who are partway through onboarding
- Actual investors who have fully committed and uploaded documents

This makes it difficult for fund managers to see their actual investor base vs. people still in the qualification/onboarding pipeline.

## Current Problem

**The Investors page currently shows:**
- People who just completed KYC (not yet qualified)
- People who had a meeting but haven't started onboarding
- People who are halfway through the onboarding form
- People who uploaded validation documents but aren't approved yet
- People who are fully approved and have invested

**This creates issues:**
1. Fund managers can't see a clean list of actual investors
2. No clear pipeline view of prospects at different stages
3. "Add Investor" button is confusing (is it for adding prospects or confirmed investors?)
4. No way to manually send KYC forms without "adding" someone to investors list
5. Status tracking is unclear (who's where in the process?)
6. Metrics are misleading (total investors includes non-investors)

## Required Solution

**Create two separate pages:**
1. **Onboarding/Pipeline Page:** Track all prospects through the qualification process
2. **Investors Page:** Clean list of only confirmed, active investors who have completed everything

**Plus:** Implement three ways to send KYC forms without cluttering the Investors list.

---

## Technical Requirements

### Part 1: New Onboarding/Pipeline Page

**Create a new page in the sidebar: "Onboarding" or "Pipeline"**

**Purpose:** Track prospects from initial interest through to becoming an investor

**Display columns:**
- Name (First, Last)
- Email
- Phone
- Status (see status definitions below)
- Stage (KYC Submitted, Meeting Booked, Onboarding, Documents Pending, Validation, etc.)
- Last Activity Date
- Actions (View, Send Reminder, Approve, Reject)

**Status definitions for pipeline:**
```javascript
const PIPELINE_STATUSES = {
  'kyc_submitted': 'KYC Submitted',
  'kyc_approved': 'Pre-Qualified',
  'meeting_scheduled': 'Meeting Scheduled',
  'meeting_completed': 'Meeting Completed',
  'onboarding_started': 'Onboarding Started',
  'onboarding_submitted': 'Onboarding Submitted',
  'documents_pending': 'Documents Pending Validation',
  'documents_rejected': 'Documents Rejected',
  'approved_pending_signature': 'Approved - Pending Signature',
  'docusign_sent': 'DocuSign Sent',
  'ready_to_invest': 'Ready to Invest',
  'rejected': 'Rejected'
}
```

**Filters available:**
- By status
- By date range
- By fund (if multiple funds)
- Search by name/email

**Actions per prospect:**
- View details (opens modal with all their info)
- Send reminder email
- Send KYC link (if not started)
- Send onboarding link (if approved from meeting)
- Approve/Reject validation documents
- Move to Investors (when fully approved + invested)

**Metrics at top of page:**
- Total Prospects in Pipeline
- KYC Submitted This Week
- Meetings Scheduled
- Pending Document Validation
- Ready to Invest

---

### Part 2: Clean Investors Page

**Purpose:** Show ONLY confirmed, active investors who have:
- Completed full onboarding
- Had documents approved
- Signed agreements (DocuSign)
- Either made commitment or wired money

**Display columns:**
- Name (First, Last)
- Email
- Investment Amount / Commitment
- Status (Active, Inactive, Exited)
- Onboarded Date
- Deals Invested In
- Actions (View Profile, Send Message, View Documents)

**Investor status definitions:**
```javascript
const INVESTOR_STATUSES = {
  'active': 'Active',
  'inactive': 'Inactive',
  'exited': 'Exited'
}
```

**Who appears here:**
- ONLY people who have:
  1. Completed full onboarding form
  2. Had validation documents approved
  3. Signed subscription agreement (DocuSign)
  4. Have status = 'active', 'inactive', or 'exited'

**Filters available:**
- By status (Active/Inactive/Exited)
- By deal invested in
- By investment amount range
- By onboarding date
- Search by name/email

**Metrics at top of page:**
- Total Active Investors
- Total Capital Committed
- Total Capital Called
- Average Investment Amount
- New Investors This Month

**Remove current "Add Investor" button** - this was confusing

---

### Part 3: Three Ways to Send KYC Forms

**Method 1: Manual Send (Fund Manager Action)**

**Add button in Onboarding/Pipeline page header: "Send KYC Form"**

Clicking opens modal:
```
Modal: Send KYC Form
─────────────────────
First Name: [text input]
Last Name: [text input]
Email: [text input] *required
Phone: [text input]
Notes: [textarea] (optional, for internal use)

[Cancel] [Send KYC Link]
```

**What happens when submitted:**
1. Create prospect record in pipeline:
```javascript
{
  id: UUID,
  first_name: [input],
  last_name: [input],
  email: [input],
  phone: [input],
  status: 'kyc_sent',
  stage: 'KYC Sent',
  kyc_link: [unique_link],
  sent_by: [fund_manager_id],
  sent_at: [timestamp],
  notes: [input]
}
```

2. Generate unique KYC form link: `yourapp.com/kyc/[unique_token]`

3. Send email:
```
Subject: Investment Opportunity - Complete Your Pre-Qualification

Hi [First Name],

[Fund Manager Name] has invited you to explore an investment opportunity with [Fund Name].

To get started, please complete this brief pre-qualification form (takes 3-4 minutes):

[Complete Pre-Qualification Button] ← Links to unique KYC form

This will help us determine if you qualify as an accredited investor and schedule a brief call to discuss the opportunity.

Questions? Reply to this email or contact [fund manager email/phone].

Best regards,
[Fund Manager Name]
[Fund Name]
```

4. Track in pipeline with status 'kyc_sent'

---

**Method 2: Public Website Button**

**Add public-facing KYC button/link on fund's website**

**Button text options:**
- "Invest with Us"
- "Become an Investor"
- "Check If You Qualify"
- "Start Investment Process"

**URL structure:** `yourapp.com/funds/[fund_id]/kyc` or `yourapp.com/kyc?fund=[fund_id]`

**What happens:**
1. Prospect clicks button on website
2. Taken directly to KYC form (no login required)
3. Form is specific to that fund (pre-filled fund_id)
4. When submitted:
   - Creates prospect record in pipeline
   - Status: 'kyc_submitted'
   - Source: 'website'
   - Auto-send meeting invite if qualified

**Implementation:**
- Generate embeddable code snippet for fund's website
- Or provide direct URL they can link to
- Form is publicly accessible (no auth required)
- Submission creates pipeline record automatically

---

**Method 3: "I'm Interested" Form Auto-Send**

**Optional: Add an even simpler interest form**

**Minimal form on website (2-3 fields):**
- Email *required
- Name *required
- Phone (optional)
- [Submit Interest Button]

**What happens when submitted:**
1. Create pipeline record:
```javascript
{
  email: [input],
  name: [input],
  phone: [input],
  status: 'interest_expressed',
  source: 'interest_form',
  created_at: [timestamp]
}
```

2. Auto-send email immediately:
```
Subject: Thanks for Your Interest - Next Steps

Hi [Name],

Thank you for your interest in [Fund Name]!

To explore this investment opportunity, please complete this brief pre-qualification form:

[Complete Pre-Qualification Button] ← Links to KYC form

This helps us verify you qualify as an accredited investor and takes just 3-4 minutes.

We'll follow up within 24 hours to schedule a brief call.

Best regards,
[Fund Name]
```

3. Update status to 'kyc_sent'
4. Appears in pipeline

---

### Part 4: Status Progression & Automation

**Define clear status progression:**

```
1. kyc_sent (manually sent or from interest form)
   ↓
2. kyc_submitted (they completed KYC form)
   ↓
3. kyc_approved (at least 1 accreditation box checked)
   ↓ (auto-send meeting invite)
4. meeting_scheduled (they booked Calendly)
   ↓
5. meeting_completed (meeting happened)
   ↓ (fund manager manually sends onboarding link)
6. onboarding_started (they created account & started form)
   ↓
7. onboarding_submitted (they completed form + uploaded docs)
   ↓
8. documents_pending (fund manager needs to validate)
   ↓
9a. documents_approved → approved_pending_signature
   ↓ (auto-send DocuSign)
10. docusign_sent
   ↓
11. docusign_signed → ready_to_invest
   ↓ (send wire instructions)
12. wire_received → MOVE TO INVESTORS PAGE as 'active'

OR

9b. documents_rejected → back to onboarding_started
    (send rejection email with instructions)
```

**Automated transitions:**
- KYC submitted → auto-check accreditation boxes → if approved, auto-send meeting invite
- Documents approved → auto-send DocuSign
- DocuSign signed → auto-send wire instructions
- Wire received → auto-move to Investors page + send welcome email

**Manual transitions:**
- Meeting completed → Fund manager decides to proceed
- Documents validation → Fund manager approves/rejects
- Status updates (if prospect goes cold, mark as inactive)

---

### Part 5: When Someone Moves to Investors Page

**Trigger: Wire received (or commitment confirmed)**

**Automated process:**
1. Update prospect record:
   - status = 'converted_to_investor'
   - converted_at = [timestamp]

2. Create investor record:
```javascript
{
  id: UUID,
  user_id: [from prospect account],
  fund_id: [fund_id],
  first_name: [from prospect],
  last_name: [from prospect],
  email: [from prospect],
  phone: [from prospect],
  status: 'active',
  commitment_amount: [from onboarding form],
  capital_called: 0,
  capital_invested: [initial wire amount],
  onboarded_at: [timestamp],
  // copy all relevant data from prospect/onboarding
}
```

3. Remove from Onboarding/Pipeline active view (or mark as converted)

4. Appears in Investors page

5. Send welcome email:
```
Subject: Welcome to [Fund Name] - You're Now an Investor!

Hi [First Name],

Welcome! Your investment in [Fund Name] is confirmed.

Investment Details:
- Amount: $[amount]
- Date: [date]
- Deal(s): [deal names]

You can now access your investor portal at:
[Login to Portal Button]

In your portal you'll find:
- Your investment documents
- Performance updates
- Capital call notices
- Quarterly reports

Questions? Your fund manager [Name] is available at [email/phone].

Thank you for investing with us!

Best regards,
[Fund Name]
```

---

### Part 6: Database Schema Changes

**Create new table: `prospects` (or rename existing)**
```sql
CREATE TABLE prospects (
  id UUID PRIMARY KEY,
  fund_id UUID REFERENCES funds(id),
  
  -- Basic info
  first_name TEXT,
  last_name TEXT,
  email TEXT NOT NULL UNIQUE,
  phone TEXT,
  
  -- Status tracking
  status TEXT NOT NULL, -- kyc_sent, kyc_submitted, etc.
  stage TEXT, -- display name for status
  source TEXT, -- manual, website, interest_form
  
  -- KYC data (when submitted)
  kyc_data JSONB, -- store all KYC form responses
  kyc_submitted_at TIMESTAMP,
  kyc_approved_at TIMESTAMP,
  
  -- Meeting tracking
  meeting_link TEXT, -- Calendly link
  meeting_scheduled_at TIMESTAMP,
  meeting_completed_at TIMESTAMP,
  
  -- Onboarding tracking
  user_id UUID REFERENCES auth.users(id), -- when account created
  onboarding_started_at TIMESTAMP,
  onboarding_submitted_at TIMESTAMP,
  
  -- Document validation
  documents_approved_at TIMESTAMP,
  documents_rejected_at TIMESTAMP,
  rejection_reason TEXT,
  
  -- DocuSign
  docusign_envelope_id TEXT,
  docusign_sent_at TIMESTAMP,
  docusign_signed_at TIMESTAMP,
  
  -- Conversion
  converted_to_investor BOOLEAN DEFAULT false,
  converted_at TIMESTAMP,
  investor_id UUID REFERENCES investors(id),
  
  -- Metadata
  notes TEXT, -- fund manager notes
  sent_by UUID REFERENCES users(id), -- which fund manager sent KYC
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_prospects_status ON prospects(status);
CREATE INDEX idx_prospects_email ON prospects(email);
CREATE INDEX idx_prospects_fund ON prospects(fund_id);
```

**Update `investors` table:**
```sql
-- Add fields to track conversion
ALTER TABLE investors ADD COLUMN prospect_id UUID REFERENCES prospects(id);
ALTER TABLE investors ADD COLUMN onboarded_at TIMESTAMP;

-- Ensure clean status
ALTER TABLE investors ADD CONSTRAINT investors_status_check 
  CHECK (status IN ('active', 'inactive', 'exited'));
```

---

### Part 7: UI/UX Changes

**Sidebar Navigation (Updated):**
```
Dashboard
Deals
Onboarding ← NEW (or "Pipeline")
Investors ← CLEANED UP
Documents
Capital Calls
Communications
Reports
Settings
```

**Onboarding/Pipeline Page Layout:**
```
┌─────────────────────────────────────────────────┐
│ Onboarding Pipeline                              │
├─────────────────────────────────────────────────┤
│                                                   │
│ [Send KYC Form] [Import Contacts] [Export CSV]  │
│                                                   │
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐               │
│ │ 24  │ │ 8   │ │ 5   │ │ 3   │               │
│ │Total│ │KYC  │ │Docs │ │Ready│               │
│ └─────┘ └─────┘ └─────┘ └─────┘               │
│                                                   │
│ Filters: [All Stages ▼] [Date ▼] [Search...]   │
│                                                   │
│ ┌───────────────────────────────────────────┐  │
│ │ Name      Email      Status    Stage      │  │
│ ├───────────────────────────────────────────┤  │
│ │ John Doe  john@...   KYC Sub   [view]     │  │
│ │ Jane Sm   jane@...   Meeting   [view]     │  │
│ │ Bob Jon   bob@...    Docs Pend [approve]  │  │
│ └───────────────────────────────────────────┘  │
└─────────────────────────────────────────────────┘
```

**Investors Page Layout (Cleaned):**
```
┌─────────────────────────────────────────────────┐
│ Investors                                        │
├─────────────────────────────────────────────────┤
│                                                   │
│ [Export List] [Send Group Email]                │
│                                                   │
│ ┌─────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│ │ 15  │ │$2.4M    │ │$1.8M    │ │$160K    │  │
│ │Active│ │Committed│ │Called   │ │Avg      │  │
│ └─────┘ └─────────┘ └─────────┘ └─────────┘  │
│                                                   │
│ Filters: [Active ▼] [Deal ▼] [Search...]       │
│                                                   │
│ ┌───────────────────────────────────────────┐  │
│ │ Name      Email    Committed  Deals       │  │
│ ├───────────────────────────────────────────┤  │
│ │ Alice W   alice    $250K      2 deals     │  │
│ │ Carlos M  carlos   $150K      1 deal      │  │
│ │ Diana K   diana    $500K      3 deals     │  │
│ └───────────────────────────────────────────┘  │
└─────────────────────────────────────────────────┘
```

---

### Part 8: API Endpoints Needed

**Prospects/Pipeline:**
```javascript
POST   /api/prospects/send-kyc
  Body: { firstName, lastName, email, phone, notes }
  Action: Create prospect + send KYC email

GET    /api/prospects
  Query: ?status=kyc_submitted&fund_id=xxx
  Returns: List of prospects with filters

GET    /api/prospects/:id
  Returns: Full prospect details + history

PATCH  /api/prospects/:id/status
  Body: { status: 'meeting_completed' }
  Action: Update prospect status

POST   /api/prospects/:id/approve-documents
  Action: Approve validation docs + trigger DocuSign

POST   /api/prospects/:id/reject-documents
  Body: { reason: 'Need clearer tax documents' }
  Action: Reject + send email

POST   /api/prospects/:id/convert-to-investor
  Action: Move to investors table

POST   /api/kyc/submit
  Body: { ...kyc_form_data, prospect_token }
  Action: Update prospect with KYC data
```

**Investors:**
```javascript
GET    /api/investors
  Query: ?status=active&fund_id=xxx
  Returns: Only confirmed investors

GET    /api/investors/:id
  Returns: Full investor profile

PATCH  /api/investors/:id
  Body: { status: 'inactive' }
  Action: Update investor status
```

---

### Part 9: Email Templates

**Template 1: Manual KYC Send**
```
Subject: Investment Opportunity with [Fund Name]

Hi [First Name],

[Fund Manager Name] from [Fund Name] has invited you to explore an investment opportunity.

To get started, please complete this brief 3-minute pre-qualification form:

[Complete Pre-Qualification] ← Button

This helps us verify you qualify as an accredited investor and we'll follow up to schedule a call.

Questions? Reply to this email or contact [Fund Manager] at [contact info].

Best regards,
[Fund Manager Name]
[Fund Name]
```

**Template 2: Auto-Send After Interest Form**
```
Subject: Thanks for Your Interest - Complete Pre-Qualification

Hi [Name],

Thank you for expressing interest in [Fund Name]!

Next step: Please complete this brief pre-qualification form (takes 3-4 minutes):

[Complete Pre-Qualification] ← Button

This verifies you qualify as an accredited investor. We'll follow up within 24 hours to schedule a brief call.

Looking forward to speaking with you!

Best regards,
[Fund Name]
```

**Template 3: KYC Approved - Meeting Invite**
```
Subject: Pre-Qualified! Schedule Your Call with [Fund Manager]

Hi [First Name],

Great news - you're pre-qualified as an accredited investor!

Next step: Schedule a brief 15-minute call with [Fund Manager Name] to discuss the investment opportunity:

[Schedule Call] ← Button (Calendly link)

We'll review the fund details, answer your questions, and outline next steps if you decide to proceed.

Best regards,
[Fund Manager Name]
[Fund Name]
```

**Template 4: Post-Meeting - Start Onboarding**
```
Subject: Create Your Investor Account - [Fund Name]

Hi [First Name],

Thank you for our conversation! To move forward with your investment, please create your secure investor account:

[Create Account] ← Button

This takes about 5 minutes and includes:
- Creating your account
- Completing your investor profile
- Uploading verification documents

Questions? Reply to this email.

Best regards,
[Fund Manager Name]
```

**Template 5: Documents Approved - DocuSign**
```
Subject: Investment Documents Ready for Signature

Hi [First Name],

Your verification documents have been approved!

Next step: Please review and sign your investment documents:

[Sign Documents] ← Button (DocuSign)

Documents to sign:
- Subscription Agreement ($[amount] investment)
- Private Placement Memorandum Acknowledgement

After signing, you'll receive wire instructions to complete your investment.

Best regards,
[Fund Manager Name]
[Fund Name]
```

**Template 6: Documents Rejected - Resubmit**
```
Subject: Action Required - Document Resubmission Needed

Hi [First Name],

We reviewed your verification documents and need additional information:

Reason: [rejection reason text]

Please log in to your account and upload new documents:

[Upload Documents] ← Button

What we need:
- [specific documents requested]

Questions? Reply to this email or call [phone].

Best regards,
[Fund Manager Name]
```

**Template 7: DocuSign Completed - Wire Instructions**
```
Subject: Final Step - Wire Transfer Instructions

Hi [First Name],

Congratulations! Your investment documents are signed.

Final step: Wire your investment of $[amount] to:

Bank Name: [bank]
Account Name: [account name]
Account Number: [number]
Routing Number: [routing]
Reference: [reference code - IMPORTANT]

⚠️ Important: Include reference code [XXX] in your wire transfer

We'll confirm receipt within 1 business day.

Questions? Contact [fund manager] at [contact info].

Best regards,
[Fund Manager Name]
[Fund Name]
```

**Template 8: Welcome to Investors**
```
Subject: Welcome - You're Now an Investor in [Fund Name]!

Hi [First Name],

Welcome to [Fund Name]! Your investment is confirmed.

Investment Details:
- Amount: $[amount]
- Date: [date]
- Deal(s): [deal names]
- Reference: [reference]

Access Your Portal:
[Login to Portal] ← Button

In your portal:
✓ Investment documents
✓ Performance updates
✓ Capital call notices
✓ Quarterly reports

Your fund manager [Name] is available at [email/phone] for any questions.

Thank you for investing with us!

Best regards,
[Fund Name] Team
```

---

### Part 10: Reminder Automation

**Auto-reminders for prospects who don't complete stages:**

**If KYC sent but not completed (48 hours later):**
```
Subject: Reminder: Complete Your Pre-Qualification Form

Hi [First Name],

We noticed you haven't completed your pre-qualification form yet.

[Complete Pre-Qualification] ← Button

This only takes 3-4 minutes and is required to move forward.

Questions? Reply to this email.

Best regards,
[Fund Manager Name]
```

**If meeting scheduled but not attended (1 hour after):**
```
Subject: Missed Our Call - Let's Reschedule

Hi [First Name],

We missed you on our scheduled call today. No problem - let's find another time!

[Reschedule Call] ← Button

Or reply to this email with times that work better for you.

Best regards,
[Fund Manager Name]
```

**If onboarding started but not completed (3 days later):**
```
Subject: Complete Your Investor Profile

Hi [First Name],

You're almost done! Please complete your investor profile to move forward:

[Continue Profile] ← Button

Remaining steps:
- Upload verification documents
- Banking information
- Final review

Questions? Reply to this email.

Best regards,
[Fund Manager Name]
```

---

## Success Criteria

The implementation is successful when:

1. ✅ Fund managers can send KYC forms via "Send KYC" button
2. ✅ Public KYC form works on website (no login required)
3. ✅ Interest form auto-sends KYC link
4. ✅ All prospects appear in Onboarding/Pipeline page
5. ✅ Clear status tracking through entire pipeline
6. ✅ Investors page shows ONLY confirmed investors
7. ✅ Automatic status transitions work (KYC approved → meeting invite, etc.)
8. ✅ Manual transitions work (approve/reject documents)
9. ✅ Prospects automatically move to Investors when wire received
10. ✅ All email templates send at correct triggers
11. ✅ Fund managers can see pipeline metrics
12. ✅ Fund managers can see investor metrics separately
13. ✅ No confusion between prospects and investors

---

## Deliverables

Please create a detailed implementation plan that includes:

1. **Database migrations**
   - Create prospects table
   - Update investors table
   - Data migration plan (existing data)

2. **API endpoints**
   - Prospects CRUD
   - Status updates
   - KYC submission
   - Conversion to investor

3. **Frontend components**
   - New Onboarding/Pipeline page
   - Clean Investors page
   - Send KYC modal
   - Status badges/indicators
   - Metrics dashboard

4. **Forms**
   - Public KYC form (no auth)
   - Interest form
   - Prospect detail view

5. **Email system**
   - All templates
   - Trigger conditions
   - Reminder automation

6. **Business logic**
   - Status transition rules
   - Automatic triggers
   - Manual approval flows
   - Conversion logic

7. **Testing plan**
   - Full pipeline flow
   - Each transition point
   - Email triggers
   - Data integrity

8. **Timeline estimate**

---

## Additional Context

- Current "Investors" page is confusing because it mixes prospects and investors
- Fund managers need to see pipeline health (how many at each stage)
- Fund managers need clean investor list for reporting
- Multiple ways to get prospects into pipeline (manual, website, interest form)
- Status must be clear and trackable through entire journey
- Security: public KYC form must not expose fund data
- Automation: reduce manual work where possible
- Clarity: fund managers should immediately understand who's where

Based on this prompt, please create a comprehensive implementation plan with all technical specifications, step-by-step instructions, and code structure recommendations.